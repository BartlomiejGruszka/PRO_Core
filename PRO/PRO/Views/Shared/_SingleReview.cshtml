@model Tuple<PRO.Entities.Review, int?>
@using PRO.Domain.Extensions

<div class="borderDark" style="padding: 4px 0;">
    <div class="spaceit" style="display: flex; justify-content: space-between;">

        <div style="float: left; padding-bottom:12px;">
            <table border="0" cellpadding="0" cellspacing="0" width="100%" style="padding-left: 3px;">
                <tbody>

                    @if (ViewContext.RouteData.Values["controller"].ToString() == "Users")
                    {
                        <tr>
                            <td valign="top" width="60">
                                <div class="">

                                    @if (Model.Item1.Game.Image != null)
                                    {<a href="/games/@Model.Item1.GameId">
                                            <img style="max-width: 100%; max-height: 100%;" class=" lazyloaded" src="/images/@Model.Item1.Game.Image.ImagePath">
                                        </a>
                                    }

                                </div>
                            </td>
                            <td valign="top" style="padding-left: 10px;">
                                <a href="/games/@Model.Item1.GameId">@Model.Item1.Game.Title</a>
                            </td>
                        </tr>
                    }
                    else
                    {
                        <tr>
                            <td valign="top" width="60">
                                <div class="">

                                    @if (Model.Item1.User.Image != null)
                                    {<a href="/users/@Model.Item1.UserId">
                                            <img style="max-width: 100%; max-height: 100%;" class=" lazyloaded" src="/images/@Model.Item1.User.Image.ImagePath">
                                        </a>
                                    }

                                </div>
                            </td>
                            <td valign="top" style="padding-left: 10px;">
                                <a href="/users/@Model.Item1.UserId">@Model.Item1.User.UserName</a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <div class="mb8" style="float: right; text-align: right;">
            <div title="">@Model.Item1.ReviewDate.ToShortDateString()</div>
            <div class="lightLink spaceit">
                @{int? myInt = Model.Item2 == null ? 0 : Model.Item2; }
                Rozegrane: @myInt h
            </div>
            @{
                {
                    int avg = (Model.Item1.GameplayScore + Model.Item1.GraphicsScore + Model.Item1.MusicScore + Model.Item1.StoryScore) / 4;
                    if (Model.Item1.ModeratorId != null)
                    { <div class="lightLink spaceit">
                            Średnia ocena: @avg
                        </div>
                      <div>
                          Edytowano: @Model.Item1.EditDate.Value.ToShortDateString()
                      </div>
                    }
                    else
                    {
                        <div>
                            Średnia ocena: @avg
                        </div>
                    }


                } }

        </div>

    </div>
    @{ if (ViewContext.RouteData.Values["action"].ToString() == "SingleReview")
        {
            <div class="spaceit" style="clear: both; border-top: 1px solid #ebebeb; display:flex; justify-content:flex-end; flex-direction:column">
                <p class="reviewRatings">Grywalność:    @Model.Item1.GameplayScore</p>
                <p class="reviewRatings">Grafika:   @Model.Item1.GraphicsScore</p>
                <p class="reviewRatings">Fabuła:    @Model.Item1.StoryScore</p>
                <p class="reviewRatings">Muzyka:    @Model.Item1.MusicScore</p>
            </div>}
    }

    <div class="spaceit textReadability word-break pt8 mt8" style="clear: both; border-top: 1px solid #ebebeb; border-bottom: 1px solid #ebebeb;">



        @{ if (ViewContext.RouteData.Values["action"].ToString() != "SingleReview")
            {
                @Html.Raw(@Model.Item1.Content.Truncate(200))<text>... </text>
                <a href="/games/@Model.Item1.GameId/reviews/@Model.Item1.Id">więcej </a>
            }
            else
            {
                @Html.Raw(@Model.Item1.Content)
            }
        }

    </div>

</div>
